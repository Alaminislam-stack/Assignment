import{j as a}from"./jsx-runtime-u17CrQMm.js";import{r as p}from"./iframe-DKZm4Ru4.js";import"./preload-helper-PPVm8Dsz.js";const k=async(r,c)=>{if(!r.validation)return null;for(const i of r.validation)switch(i.type){case"required":if(c==null||c===""||Array.isArray(c)&&c.length===0)return i.message;break;case"pattern":if(c&&!new RegExp(i.value).test(c))return i.message;break;case"minLength":if(c&&c.length<i.value)return i.message;break;case"async":if(c&&(await new Promise(n=>setTimeout(n,800)),c.toLowerCase()==="admin"))return i.message;break}return null},A=(r,c)=>{if(!r)return!0;const{field:i,eq:n}=r;return c[i]===n},T=({schema:r,onSubmit:c,autosave:i=!1})=>{const[n,b]=p.useState({}),[u,N]=p.useState({}),[D,w]=p.useState({}),[f,j]=p.useState("idle");p.useEffect(()=>{const e={};r.fields.forEach(t=>{t.type==="repeater"?e[t.name]=[{}]:t.type==="checkbox"?e[t.name]=!1:e[t.name]=""}),b(e)},[r]);const R=p.useCallback(async(e,t,o)=>{w(l=>({...l,[e]:!0}));const s=await k(o,t);return N(l=>({...l,[e]:s||""})),w(l=>({...l,[e]:!1})),s},[n]),h=async(e,t,o)=>{const s={...n,[e]:t};b(s),await R(e,t,o),i&&F(s)},[q,L]=p.useState(null),F=e=>{q&&clearTimeout(q),j("saving");const t=setTimeout(()=>{j("saved"),setTimeout(()=>j("idle"),2e3),console.log("Autosaved:",e)},1e3);L(t)},C=(e,t,o,s)=>{const l=[...n[e.name]||[]];l[t]={...l[t],[o]:s};const m={...n,[e.name]:l};b(m),i&&F(m)},E=e=>{const t=[...n[e]||[],{}];b({...n,[e]:t})},I=(e,t)=>{const o=(n[e]||[]).filter((s,l)=>l!==t);b({...n,[e]:o})},P=async e=>{e.preventDefault();const t={};for(const o of r.fields)if(A(o.condition,n)){const s=await k(o,n[o.name]);s&&(t[o.name]=s)}N(t),Object.keys(t).length===0&&c(n)},$=e=>{if(!A(e.condition,n))return null;const t="border border-gray-200 rounded-md p-2 w-full focus:ring-2 focus:ring-blue-500 focus:outline-none transition-all",o="block text-sm font-medium text-gray-700 mb-1";switch(e.type){case"text":case"email":case"password":case"tel":case"url":return a.jsxs("div",{className:"relative",children:[a.jsx("label",{htmlFor:e.name,className:o,children:e.label}),a.jsx("input",{type:e.type,id:e.name,className:`${t} ${u[e.name]?"border-red-500":""}`,placeholder:e.placeholder,value:n[e.name]||"",onChange:s=>h(e.name,s.target.value,e),"aria-invalid":!!u[e.name],"aria-describedby":u[e.name]?`${e.name}-error`:void 0}),D[e.name]&&a.jsx("span",{className:"absolute right-3 top-9 text-blue-500 text-xs",children:"checking..."}),u[e.name]&&a.jsx("p",{id:`${e.name}-error`,className:"text-red-500 text-xs mt-1",children:u[e.name]})]},e.name);case"textarea":return a.jsxs("div",{children:[a.jsx("label",{htmlFor:e.name,className:o,children:e.label}),a.jsx("textarea",{id:e.name,className:`${t} ${u[e.name]?"border-red-500":""}`,placeholder:e.placeholder,rows:4,value:n[e.name]||"",onChange:s=>h(e.name,s.target.value,e)}),u[e.name]&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:u[e.name]})]},e.name);case"select":return a.jsxs("div",{children:[a.jsx("label",{htmlFor:e.name,className:o,children:e.label}),a.jsxs("select",{id:e.name,className:`${t} bg-white`,value:n[e.name]||"",onChange:s=>h(e.name,s.target.value,e),children:[a.jsx("option",{value:"",children:e.placeholder||"Select an option"}),e.options?.map(s=>a.jsx("option",{value:s.value,children:s.label},s.value))]}),u[e.name]&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:u[e.name]})]},e.name);case"checkbox":return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:e.name,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:n[e.name]||!1,onChange:s=>h(e.name,s.target.checked,e)}),a.jsx("label",{htmlFor:e.name,className:"text-sm font-medium text-gray-700",children:e.label})]},e.name);case"repeater":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:o,children:e.label}),(n[e.name]||[]).map((s,l)=>a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200 relative animate-in fade-in slide-in-from-top-1",children:[e.fields?.map(m=>a.jsxs("div",{className:"mb-3 last:mb-0",children:[a.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1",children:m.label}),m.type==="select"?a.jsx("select",{className:`${t} bg-white py-1 text-sm`,value:s[m.name]||"",onChange:d=>C(e,l,m.name,d.target.value),children:m.options?.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))}):a.jsx("input",{type:m.type,className:`${t} py-1 text-sm`,value:s[m.name]||"",onChange:d=>C(e,l,m.name,d.target.value)})]},m.name)),l>0&&a.jsx("button",{type:"button",onClick:()=>I(e.name,l),className:"absolute -top-2 -right-2 bg-red-100 text-red-600 rounded-full p-1 hover:bg-red-200 transition-colors",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:a.jsx("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})})]},l)),a.jsx("button",{type:"button",onClick:()=>E(e.name),className:"text-blue-600 text-sm font-semibold flex items-center gap-1 hover:text-blue-700 transition-colors",children:a.jsxs("span",{children:["+ Add ",e.label.replace(/s$/,"")]})})]},e.name);default:return null}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:r.title}),a.jsx("p",{className:"text-sm text-gray-500",children:r.description})]}),i&&a.jsxs("div",{className:"text-xs font-medium",children:[f==="saving"&&a.jsx("span",{className:"text-blue-500 animate-pulse",children:"Saving..."}),f==="saved"&&a.jsx("span",{className:"text-green-500",children:"Saved"})]})]}),a.jsxs("form",{onSubmit:P,className:"space-y-4",children:[r.fields.map($),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white font-semibold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all cursor-pointer",children:"Submit"})]})]})};T.__docgenInfo={description:"",methods:[],displayName:"FormRenderer",props:{schema:{required:!0,tsType:{name:"FormSchema"},description:""},onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: any) => void",signature:{arguments:[{type:{name:"any"},name:"data"}],return:{name:"void"}}},description:""},autosave:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};const B={id:"contact-form",version:1,title:"Contact Form",description:"A simple contact form with basic validation.",fields:[{name:"name",label:"Full Name",type:"text",placeholder:"John Doe",validation:[{type:"required",message:"Name is required"}]},{name:"email",label:"Email",type:"email",placeholder:"john@example.com",validation:[{type:"required",message:"Email is required"},{type:"pattern",value:"^[^@]+@[^@]+.[^@]+$",message:"Enter a valid email"}]},{name:"subject",label:"Subject",type:"select",placeholder:"Choose a subject",options:[{label:"General Inquiry",value:"general"},{label:"Bug Report",value:"bug"},{label:"Feature Request",value:"feature"}],validation:[{type:"required",message:"Please select a subject"}]},{name:"message",label:"Message",type:"textarea",placeholder:"Your message...",validation:[{type:"required",message:"Message is required"},{type:"minLength",value:10,message:"Message must be at least 10 characters"}]},{name:"subscribe",label:"Subscribe to newsletter",type:"checkbox"}]},U={id:"conditional-form",version:1,title:"Conditional Logic",description:"Fields appear or disappear based on other field values.",fields:[{name:"accountType",label:"Account Type",type:"select",options:[{label:"Personal",value:"personal"},{label:"Business",value:"business"}],validation:[{type:"required",message:"Account type is required"}]},{name:"businessName",label:"Business Name",type:"text",placeholder:"Your company name",validation:[{type:"required",message:"Business name is required"}],condition:{field:"accountType",eq:"business"}},{name:"businessId",label:"Business ID",type:"text",placeholder:"ABN / Tax ID",validation:[{type:"required",message:"Business ID is required"}],condition:{field:"accountType",eq:"business"}},{name:"personalId",label:"Personal ID",type:"text",placeholder:"Driver's license / Passport",validation:[{type:"required",message:"Personal ID is required"}],condition:{field:"accountType",eq:"personal"}}]},V={id:"repeater-form",version:1,title:"Repeaters",description:"Add multiple items like phone numbers or addresses.",fields:[{name:"name",label:"Full Name",type:"text",validation:[{type:"required",message:"Name is required"}]},{name:"phones",label:"Phone Numbers",type:"repeater",fields:[{name:"number",label:"Phone Number",type:"tel",validation:[{type:"required",message:"Phone number is required"}]},{name:"type",label:"Type",type:"select",options:[{label:"Mobile",value:"mobile"},{label:"Home",value:"home"},{label:"Work",value:"work"}]}]}]},M={id:"async-form",version:1,title:"Async Validation",description:"Username availability checked in real-time.",fields:[{name:"username",label:"Username",type:"text",placeholder:"Choose a username",validation:[{type:"required",message:"Username is required"},{type:"minLength",value:3,message:"Username must be at least 3 characters"},{type:"async",value:"/api/check-username",message:"Username already taken"}]},{name:"password",label:"Password",type:"password",validation:[{type:"required",message:"Password is required"},{type:"minLength",value:8,message:"Password must be at least 8 characters"}]}]},_={id:"autosave-form",version:1,title:"Autosave",description:"Changes are saved automatically as you type.",fields:[{name:"bio",label:"Biography",type:"textarea",placeholder:"Tell us about yourself...",validation:[{type:"minLength",value:10,message:"Bio must be at least 10 characters"}]},{name:"website",label:"Website",type:"url",placeholder:"https://example.com",validation:[{type:"pattern",value:"^https?://.+$",message:"Enter a valid URL"}]}]},z={title:"Engine/FormRenderer",component:T,parameters:{layout:"centered"},tags:["autodocs"]},g={args:{schema:B,onSubmit:r=>console.log("Contact Form Submitted:",r),autosave:!1}},y={args:{schema:U,onSubmit:r=>console.log("Conditional Form Submitted:",r)}},x={args:{schema:V,onSubmit:r=>console.log("Repeater Form Submitted:",r)}},v={args:{schema:M,onSubmit:r=>console.log("Async Form Submitted:",r)}},S={args:{schema:_,autosave:!0,onSubmit:r=>console.log("Autosave Form Submitted:",r)}};g.parameters={...g.parameters,docs:{...g.parameters?.docs,source:{originalSource:`{
  args: {
    schema: contactFormSchema,
    onSubmit: data => console.log("Contact Form Submitted:", data),
    autosave: false
  }
}`,...g.parameters?.docs?.source}}};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:`{
  args: {
    schema: conditionalFormSchema,
    onSubmit: data => console.log("Conditional Form Submitted:", data)
  }
}`,...y.parameters?.docs?.source}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    schema: repeaterFormSchema,
    onSubmit: data => console.log("Repeater Form Submitted:", data)
  }
}`,...x.parameters?.docs?.source}}};v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:`{
  args: {
    schema: asyncFormSchema,
    onSubmit: data => console.log("Async Form Submitted:", data)
  }
}`,...v.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    schema: autosaveFormSchema,
    autosave: true,
    onSubmit: data => console.log("Autosave Form Submitted:", data)
  }
}`,...S.parameters?.docs?.source}}};const G=["ContactForm","ConditionalLogic","Repeaters","AsyncValidation","Autosave"];export{v as AsyncValidation,S as Autosave,y as ConditionalLogic,g as ContactForm,x as Repeaters,G as __namedExportsOrder,z as default};
